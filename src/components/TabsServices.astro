---
const servicios = [
  {
    tipo: "preventiva",
    titulo: "Ciberseguridad Preventiva",
    items: [
      {
        titulo: "Auditorías Web",
        slug: "auditorias-web",
        descripcion:
          "Identificación manual de vulnerabilidades en sitios y aplicaciones web.",
        puntos: [
          "Metodología OWASP",
          "Informe técnico y ejecutivo",
          "Recomendaciones de mitigación",
        ],
      },
      {
        titulo: "Informes de Presencia en Deep Web",
        slug: "informes-presencia-deep-web",
        descripcion:
          "Análisis de exposición de datos corporativos o personales en la deep y dark web.",
        puntos: [
          "Búsqueda de fugas de credenciales",
          "Monitorización de menciones y filtraciones",
          "Alertas de exposición detectada",
        ],
      },
      {
        titulo: "Auditorías de Infraestructura, WiFi y Apps Móviles",
        slug: "auditorias-infraestructura-wifi-app-movil",
        descripcion:
          "Evaluación técnica completa de redes, sistemas y aplicaciones móviles.",
        puntos: [
          "Pruebas de seguridad en red y WiFi",
          "Hardening de servidores y routers",
          "Análisis de permisos y APIs móviles",
        ],
      },
    ],
  },
  {
    tipo: "reactiva",
    titulo: "Ciberseguridad Reactiva",
    items: [
      {
        titulo: "Análisis Forense de Incidentes",
        slug: "analisis-forense",
        descripcion:
          "Investigación técnica de dispositivos afectados por incidentes de seguridad.",
        puntos: [
          "Adquisición y análisis de evidencias",
          "Reconstrucción temporal de eventos",
          "Informe forense detallado",
        ],
      },
      {
        titulo: "Asesoramiento en Corrección de Vulnerabilidades",
        slug: "asesoramiento-correccion-vulnerabilidades",
        descripcion:
          "Guía técnica para aplicar medidas correctivas y validar su efectividad.",
        puntos: [
          "Priorización de riesgos",
          "Implementación guiada de soluciones",
          "Verificación post-corrección",
        ],
      },
      {
        titulo: "Peritaje Informático",
        slug: "peritaje-informatico",
        descripcion:
          "Elaboración de informes periciales válidos ante procesos legales o internos.",
        puntos: [
          "Cadena de custodia",
          "Análisis técnico especializado",
          "Informe pericial certificado",
        ],
      },
      {
        titulo: "Recuperación de Datos Borrados",
        slug: "recuperacion-datos-borrados",
        descripcion:
          "Servicio especializado para recuperar datos eliminados o formateados en distintos dispositivos.",
        puntos: [
          "Análisis previo de viabilidad",
          "Recuperación lógica y física",
          "Informe de resultados",
        ],
      },
    ],
  },
  {
    tipo: "avanzada",
    titulo: "Ciberseguridad Avanzada",
    items: [
      {
        titulo: "Monitorización Activa de Infraestructura y Correo",
        slug: "monitorizacion-activa-infraestructura-correo",
        descripcion:
          "Supervisión continua de servidores, redes y plataformas en la nube para detectar amenazas en tiempo real.",
        puntos: [
          "Integración con Wazuh u otras soluciones SIEM",
          "Alertas automáticas y respuesta inmediata",
          "Informes periódicos de actividad",
        ],
      },
      {
        titulo: "Phishing Controlado",
        slug: "phishing-controlado",
        descripcion:
          "Simulaciones de ataque para evaluar la madurez y respuesta del personal ante intentos de suplantación.",
        puntos: [
          "Campañas realistas personalizadas",
          "Evaluación de resultados",
          "Informe con acciones de mejora",
        ],
      },
    ],
  },
  {
    tipo: "formacion",
    titulo: "Formación y Concienciación",
    items: [
      {
        titulo: "Charlas y Talleres",
        slug: "charlas-y-talleres",
        descripcion:
          "Sesiones prácticas adaptadas a distintos niveles y áreas de la organización.",
        puntos: [
          "Buenas prácticas de ciberseguridad",
          "Gestión de contraseñas y accesos",
          "Buenas prácticas de seguridad digital en el trabajo diario",
        ],
      },
      {
        titulo: "Formación por Roles",
        slug: "formacion-por-roles",
        descripcion:
          "Programas adaptados a las funciones de cada perfil profesional.",
        puntos: [
          "Directivos y personal de gestión",
          "Departamentos técnicos y financieros",
          "Desarrolladores y soporte",
        ],
      },
    ],
  },
];

let selectedServicio = "preventiva";
---

<section
  class="section tabs bg-section-dark py-16 dark:bg-surface-dark sm:py-24"
  id="servicios"
  aria-labelledby="servicios-title"
>
  <div class="container mx-auto px-4 sm:px-6 lg:px-8">
    <h2
      class="text-3xl font-extrabold text-white sm:text-4xl text-center"
      id="servicios-title"
    >
      Servicios Nyxion
    </h2>
    <p
      class="mt-4 text-lg text-text-muted-dark dark:text-text-muted-dark text-center"
    >
      Cobertura total en cuatro líneas:
      <strong>Preventiva</strong>, <strong>Reactiva</strong>,
      <strong>Avanzada</strong> y <strong>Formación</strong>. Intervenimos donde
      más impacto tiene para tu negocio.
    </p>

    <!-- Tabs solo en móvil -->

 <div class="flex flex-col justify-center gap-3 mt-8 lg:hidden">
  {servicios.map((s, i) => (
    <button
      data-tab={s.tipo}
      class={`mobile-tab-btn w-full rounded-full font-semibold transition-all duration-200 ease-in-out border 
        px-5 py-2.5 focus:outline-none
        ${
          i === 0
            ? "bg-[#00648F] text-white border-[#00648F] shadow-md"
            : "bg-transparent text-white/80 border-white/40 hover:bg-[#00648F]/80 hover:text-white"
        }`}
    >
      {s.titulo}
    </button>
  ))}
</div>


    <!-- Tabs escritorio -->
    <div
      class="tab-nav mt-12 hidden lg:flex flex-wrap justify-center gap-4 border-b border-border-light dark:border-border-dark px-2"
    >
      {
        servicios.map((s) => (
          <button
            aria-label="Mostrar servicios"
            class="tab-btn whitespace-nowrap px-4 py-3 border-b-2 border-transparent
         text-sm md:text-base text-text-muted-dark
         hover:text-primary-light hover:border-primary-light
         transition-all duration-200 font-medium cursor-pointer"
            data-tab={s.tipo}
          >
            {s.titulo}
          </button>
        ))
      }
    </div>

    <!-- Paneles -->
    <div class="tab-panels mt-12">
      {
        servicios.map((s, i) => (
          <div
            id={`tab-${s.tipo}`}
            class={`cards tab-panel ${i === 0 ? "" : "hidden"} grid gap-8 md:grid-cols-2 lg:grid-cols-3`}
            role="region"
            aria-label={s.titulo}
          >
            {s.items.map((item) => (
              <article class="flex flex-col rounded-lg border border-border-light bg-background-light p-6 shadow-sm dark:border-border-dark dark:bg-background-dark transition-transform hover:scale-[1.01]">
                <h3 class="font-bold text-lg text-text-light dark:text-white">
                  {item.titulo}
                </h3>
                <p class="mt-2 text-text-muted-light dark:text-text-muted-dark">
                  {item.descripcion}
                </p>
                <ul class="mt-2 list-disc pl-5 text-sm text-text-muted-light dark:text-text-muted-dark">
                  {item.puntos.map((p) => (
                    <li>{p}</li>
                  ))}
                </ul>

                <a
                  href={`/servicios/ciberseguridad-${s.tipo}`}
                  class="mt-auto self-end rounded-lg bg-primary px-3 py-1.5 text-sm font-semibold text-white shadow-sm hover:bg-secondary-blue transition-colors"
                >
                  Descubrir más
                </a>
              </article>
            ))}
          </div>
        ))
      }
    </div>
  </div>
</section>

<script is:inline>
  document.addEventListener("DOMContentLoaded", () => {
    const buttons = document.querySelectorAll(".tab-btn");
    const panels = document.querySelectorAll(".tab-panel");
    const select = document.getElementById("mobile-tabs");

    // --- Estado inicial ---
    if (buttons.length && panels.length) {
      buttons[0].classList.add("text-white", "font-semibold", "border-primary");
      panels[0].classList.remove("hidden");
      if (select) select.value = buttons[0].dataset.tab;
    }

    // --- Click tabs escritorio ---
    buttons.forEach((btn) => {
      btn.addEventListener("click", () => {
        const target = btn.dataset.tab;
        buttons.forEach((b) =>
          b.classList.remove("text-white", "font-semibold", "border-primary"),
        );
        panels.forEach((panel) => panel.classList.add("hidden"));

        btn.classList.add("text-white", "font-semibold", "border-primary");
        document.getElementById(`tab-${target}`).classList.remove("hidden");

        if (select) select.value = target;
      });
    });

    // --- Cambio en móvil (dropdown) ---
    // --- Click tabs móvil ---
    const mobileButtons = document.querySelectorAll(".mobile-tab-btn");

    if (mobileButtons.length) {
      // Estado inicial: activa el primero
      mobileButtons[0].classList.add(
        "bg-[#00648F]",
        "text-white",
        "border-[#00648F]",
        "shadow-md",
      );
      panels[0].classList.remove("hidden");

      mobileButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          const target = btn.dataset.tab;

          // Reinicia todos al estilo inactivo
          mobileButtons.forEach((b) => {
            b.classList.remove(
              "bg-[#00648F]",
              "text-white",
              "border-[#00648F]",
              "shadow-md",
            );
            b.classList.add(
              "bg-transparent",
              "text-white/80",
              "border-white/40",
            );
          });

          // Activa el actual
          btn.classList.remove(
            "bg-transparent",
            "text-white/80",
            "border-white/40",
          );
          btn.classList.add(
            "bg-[#00648F]",
            "text-white",
            "border-[#00648F]",
            "shadow-md",
          );

          // Cambia panel
          panels.forEach((panel) => panel.classList.add("hidden"));
          document.getElementById(`tab-${target}`).classList.remove("hidden");
        });
      });
    }
  });
</script>

<style>
  /* Fuerza que el tab-nav se oculte siempre en pantallas pequeñas */
  @media (max-width: 1023px) {
    .tab-nav {
      display: none !important;
    }
  }
</style>
